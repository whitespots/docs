# ASVS V4 SDLC Split \(rus\)

**Требования низкого уровня - первые шаги**

Приложение достигает первого уровня, если оно адекватно защищено от уязвимостей, которые легко обнаружить, они перечислены в OWAST Top 10 и похожих чек-листах. Уровень 1 является абсолютным минимумом, к которому все приложения должны стремиться. Выполнение этих требований также полезно в качестве первого шага в многоэтапной разработке или когда приложение не хранит или обрабатывает конфиденциальные данные и не нуждается в более тщательном контроле уровней 2 или 3. Контроль первого уровня может быть достигнут с использованием автоматизированных средств или вручную без доступа к исходному коду. Предполагается, что уровень 1 является минимумом, требуемым для всех приложений. Угрозы приложению, вероятнее всего, будут исходить от атакующих, которые используют простые техники для поиска простых уязвимостей, в отличии от атакующих, которые специально фокусируются на том, чтобы взломать приложение. Если ваше приложение обрабатывает ценные данные, то вы, вероятнее всего, не захотите останавливаться на первом уровне.

**Требования среднего уровня - большинство приложений**

Приложение достигает уровня 2 \(стандартного уровня\), если оно адекватно защищено против большинства рисков, связанных с программным обеспечением. Достижение уровня 2 гарантирует, что контроль безопасности присутствует, эффективен и используется в приложении. Уровень 2, обычно, подходит для приложений, которые обрабатывают значительные B2B транзакции, включая те, которые связаны с информацией о здравоохранении, обеспечивают конфиденциальные или критичные бизнес-функции или обрабатывают важные активы, или приложения, которые используются в индустриях, в которых целостность является критичным фактором для защиты бизнеса, как, например, необходимость предотвратить действия читеров или взлом игр в игровой индустрии. Атаковать приложения второго уровня обычно будут опытные и мотивированные хакеры, сфокусированные на определенных целях и использующие высокоэффективные в поиске слабых мест в приложении средства и техники.

**Требования высокого уровня - высокая ценность, высокая надежность или высокая безопасность**

Уровень 3 является самым высоким. Обычно, он используется для приложений, которые требуют значительного уровня проверки безопасности, как те приложения, которые используются в военной сфере, здравоохранении и безопасности, критичной инфраструктуре и прочих. Организациям может потребоваться уровень 3 для приложений, которые выполняют критичные функции, где отказ системы может иметь ощутимое влияние на работу организации или даже на ее выживание. Приложение достигает уровня 3 \(продвинутый уровень\) если оно адекватно защищено от продвинутых уязвимостей и демонстрирует принципы хорошего дизайна безопасности. Приложение третьего уровня требует большей глубины анализа архитектуры, кода и тестирования, нежели на других уровнях. Безопасное приложение разделяется на модули \(чтобы улучшить устойчивость, масштабируемость и уровни безопасности\) и каждый модуль \(разделенный сетевыми соединениями и / или физическими носителями\) отвечает за свою безопасность самостоятельно \(глубинная защита\), что тщательно документировано. Ответственность включает в себя контроль обеспечения конфиденциальности \(т.н. шифрование\), целостности \(транзакции, валидация ввода\), доступности \(хорошая работа с нагрузкой\), аутентификации \(в том числе, между системами\), неапеллируемости, авторизации и аудита \(логирование\).

## Менеджмент

### V1.1 Требования к процессу безопасной разработки \(SSDLC\)

**Требования среднего и высокого уровней:**

1. Принципы SSDLC используется на всех этапах разработки. 
2. Моделируются угрозы для каждого изменения в дизайне приложения или в спринтах планируется поиск угроз, планируются контрмеры и проводится тестирование на безопасность. 
3. Все пользовательские функции имеют ограничения безопасности, например "Я, как пользователь, могу просматривать и редактировать свой профиль. Я не должен видеть и редактировать чей-либо еще профиль"
4. Все точки доступа и доверия приложения, компонентов и значительных потоков данных документированы и их использование обосновано. 
5. Проведено определение и анализ высокоуровневой архитектуры приложения и всех подключенных удаленных сервисов. 
6. Внедрена централизованная, простая, проверенная, безопасная система контроля безопасности, чтобы избежать дублирования, отсутствия, неэффективного или небезопасного контроля. 
7. Всем разработчикам и тестировщикам доступны чек-листы, требования безопасности, инструкции или политики безопасности. 

## Дизайн

Здесь перечислены основные требования. Проверьте домен "Тестирование", чтобы удостовериться, что и перечисленные там требования соблюдены.

### V1.7 Ошибки, логирование и аудит

**Требования среднего и высокого уровней:**

1. В системе используется общий формат и подход к логированию.
2. Логи безопасно передаются в, предпочтительно, удаленную систему для анализа, обнаружения, оповещения и эскалации. 

### V1.8 Приватность и защита данных

**Требования среднего и высокого уровней:**

1. Все конфиденциальные данные идентифицированы и классифицированы по уровням защиты. 
2. Все уровни защиты имеют взаимосвязанные требования защиты, например, требования шифрования, целостности, сохранения, приватности и иных требований конфиденциальности и приватности и эти требования применены в архитектуре. 

### V1.9 Коммуникации

**Требования среднего и высокого уровней:**

1. Приложение шифрует коммуникации между компонентами, в частности, когда эти компоненты находятся в разных контейнерах, системах, сайтах или в разных облачных сервисах. 
2. Компоненты приложения проверяют подлинность каждой стороны коммуникации, чтобы предотвратить men-in-the-middle атаку. Например, компоненты приложения должны валидировать TLS сертификаты и цепочки доверия. 

### V1.10 Вредоносное ПО

**Требования среднего и высокого уровней:**

1. Используется система контроля исходного кода, в ней можно создать тикеты о проблемах и изменениях. В этой системе используется контроль доступа и отслеживаются любые изменения идентифицированных пользователей. 

### V1.11 Бизнес логика

**Требования среднего уровня:**

1. Определены и описаны все бизнес функции и функции безопасности компонентов приложения. 
2. Синхронизирвоаны все ценные бизнес процессы, включая аутентификацию, управление сессиями и контроль доступа. 

**Требования только высокого уровня:**

1. Все бизнес процессы, включая аутентификацию, управление сессиями, управление доступом устойчивы к атакам "time-of-check" и "time-of-use race conditions"

### V1.2 Аутентификация

**Требования среднего и высокого уровней:**

1. Во всех приложениях, компонентах, сервисах и на всех серверах используются уникальные или специальных низкопривилегированные учетные записи операционной системы
2. Используется аутентификация в коммуникациях между компонентами приложений, включая API, промежуточное ПО и уровни данных. Компоненты должны иметь привилегии не выше необходимого минимума. 
3. Приложение использует единый проверенный и безопасный механизм аутентификации, он может быть расширен для использования строгой аутентификации, имеет подробное логирование для обнаружения зловредных действий с аккаунтов. 
4. \*Все пути аутентификации и API контроля идентификации производят последовательный контроль безопасности аутентификации и нет иных небезопасных альтернатив для аутентификации. 

### V1.4 Управление доступом

**Требования среднего и высокого уровней:**

1. Все точки управления доступом, такие как шлюзы управления доступом, серверы, бессерверные функции обеспечивают контроль доступа. Управление доступом не производится на стороне клиента. 
2. Выбранное решение для управления доступом достаточно гибкое, чтобы обеспечить нужды приложения. 
3. Для всех функций, данных, URL адресов, контроллеров, сервисов и других ресурсов применяется принцип минимально необходимых привилегий. 
4. Приложение использует единственный и хорошо проверенный механизм контроля доступа для обращения к защищенным данным и ресурсам. Все запросы должны передаваться через этот единый механизм. 
5. Контроль доступа использует атрибут или функцию, которая проверяет, есть ли у данного авторизованного пользователя доступ к функции / данным, а не просто проверяет его роль. Разрешения все же должны выдаваться на основе ролей. 

### V1.5 Ввод и вывод

**Требования среднего и высокого уровней:**

1. Требования к вводу и выводу четко определяют как обрабатывать данные на основе типа, контента, применяемых законов, нормативов и других политик.  
2. Сериализация не используется в коммуникации с недоверенными клиентами. Если это невозможно, то для предотвращения атак десериализации и инъекции объектов применяются средства контроля целостности \(и шифрование, если отправляются конфиденциальные данные\). 
3. Проверка ввода используется на доверенном сервисном уровне. 
4. Убедитесь, что кодировка вывода происходит рядом с интерпретатором, для которого она предназначена, или с помощью этого интерпретатора. 

### V1.6 Криптография

**Требования среднего и высокого уровней:**

1. Существует четкая политика управления криптографическими ключами и жизненный цикл криптографического ключа соответствует стандарту управления ключами, например NIST SP 800-57.
2. Пользователи криптографических сервисов защищают конфиденциальные данные и другие секреты с помощью хранилищ ключей или альтернатив на основе API.
3. Все ключи и пароли заменяемы, работают через четко определенный процесс для возможности повторного шифрования конфиденциальных данных при смене ключа / пароля.
4. Все ключи, пароли или секреты API, сгенерированные при помощи симметричных алгоритмов, генерируемые клиентами или предоставляемые им, используются только для защиты секретов с низким уровнем риска, например, при шифровании локального хранилища, для временного использования, как, например, обфусация параметров. Обмен секретами с клиентами производится эквивалентно чистому тексту с архитектурной точки зрения. 

### V1.12 Безопасная загрузка файлов

**Требования среднего и высокого уровней:**

1. Загружаемые пользователями файлы хранятся вне директории веб-приложения. 
2. Загруженные пользователями файлы, если требуется их отображение или загрузка через приложение, обрабатываются через MIME-тип `application/octet-stream` или через внешний домен, как, например, облачное хранилище. Реализована подходящая политика безопасности контента, чтобы снизить риск от XSS-векторов или других атак со стороны загруженного файла.

### V1.14 Конфигурация

**Требования среднего и высокого уровней:**

1. Компоненты разделены на разные уровни доверия через четко определенную схему контроля безопасности, правила брандмауэра, API-шлюзы, обратные прокси, облачные группы безопасности или похожие механизмы. 
2. При развертывании исполняемых файлов на недоверенных устройствах используются подписи, доверенные соединения и проверенные конечные точки. 
3. Пайплайны предупреждают об устаревших и небезопасных компонентах при сборке и при необходимости прерывают сборку. 
4. Пайплайн содержит этап сборки для автоматической сборки и подтверждения безопасного развертывания приложения, особенно если инфраструктура приложения определяется кодом \(Software-defined infrastructure или SDI\), например, скрипты сборки облачного окружения.
5. Развертывание приложения изолировано, контейнеризовано на сетевом уровне, чтобы осложнить и задержать атаку из других приложений, особенно, если атакующие производят десериализацию.
6. Приложение не использует неподдерживаемые, небезопасные или устаревшие технологии на стороне клиента, например плагины NSAPI, Flash, Shockwave, ActiveX, Silverlight, NACL, или Java апплеты на стороне клиента.

### V2.2 Общие требования к аутентификатору

**Требования низкого, среднего и высокого уровней:**

1. Уведомления безопасности отправляются пользователям после обновлений в части аутентификации, например, при смене учетных данных, вход из неизвестных или опасных локаций. Предпочтительно использование PUSH-уведомлений вместо SMS или уведомлений по электронной почте, а в случае отсутствия возможности отправлять PUSH-уведомления, SMS или email-уведомления не должны содержать конфиденциальной информации. 

**Требования только высокого уровня::**

1. Используется защита от выдачи атакующего за клиента вследствие фишинг атак, например, через многофакторную аутентификацию, использование крипторафических устройств с подтверждением \(например, привязанные ключи, требующие нажатия для аутентификации\) или через аутентификацию на высших уровнях ALL \(Authenticator Assurance Level\), сертификаты на стороне клиента. 
2. Поставщик учетных данных \(credential service provider или CSP\) и приложение, проверяющее подлинность аутентификации, разделены и между ними находится аутентифицированный обеими сторонами TLS. 
3. Реализована защита от атаки повторного воспроизведения через использование OTP-устройств, криптографических аутентификаторов или кодов подтверждения. 
4. При попытке аутентификации, приложение требует ввода OTP-токена или действия, заданного пользователем, например, нажатия кнопки на ключе FIDO. 

### V2.3 Жизненный цикл аутентификатора

**Требования низкого, среднего и высокого уровней:**

1. Сгенерированные системой начальные пароли или коды активации создаются с помощью генератора случайных чисел, должны содержать не менее 6 символов, могут содержать буквы и цифры, истекать через короткий период времени. Эти начальные секреты не используются в долгосрочной перспективе. 

**Требования только среднего и высокого уровней:**

1. Поддерживается регистрация и использование выбранных пользователями устройств аутентификации, как, например токены U2F или FIDO. 
2. При приближении окончания срока действия аутентификатора, инструкции по обновлению отправляются пользователю с учетом достаточного времени для прохождения процедуры обновления. 

### V2.4 Хранение учетных данных

**Требования среднего и высокого уровней:**

1. \*Пароли хранятся устойчивом к офлайн атакам виде. Пароли должны быть хешированы с добавлением "соли" с использованием утвержденной функции шифрования ключа или функции хеширования пароля. Эти функции берут пароль, соль и фактор стоимости на вход, когда генерируют хэш пароля. 
2. Соль содержит в себе не менее 32 битов и была создана рандомно для минимизации возможности повторного использования этой соли среди хранимых хешей. Для каждого набора учетных данных хранится уникальное значение соли и сгенерированный хэш. 
3. Если используется PBKDF2, количество итераций должно быть велико настолько, насколько позволяет производительность верификационного сервера, что часто составляет 100 000 итераций. 
4. Если используется bcrypt, фактор работы должен быть высоким настолько, насколько это позволяет производительность сервера, что часто составляет минимум 13 единиц. 
5. Используется дополнительная итерация функции формирования ключа, где значение соли хранится в секрете и доступно только верификатору. Значение соли генерируется с использованием генератора рандомного бита \[SP 800-90Ar1\], при этом защищенность должна соответствовать последней версии стандарта SP 800-131A. Секретное значение соли должно храниться отдельно от хешированных паролей \(на специальном устройстве, например, на криптографическом ключе\)

### V4.1 Управление доступом

**Требования низкого, среднего и высокого уровней:**

1. Приложение применяет правила контроля доступа на доверенном сервисном уровне, особенно если контроль доступа присутствует на стороне клиента. 
2. Все атрибуты пользователей и данных, а также информация о политике, используемая в контроле доступа, не могут меняться конечными пользователями кроме случаев, когда пользователи авторизованы для таких изменений.
3. Для защиты от подмены и повышения привилегий, существует принцип наименьших привилегий - пользователи должны иметь доступ только к определенным функциям, файлам, URL, контроллерам, службам и другим ресурсам.
4. Существует принцип запрета по умолчанию, в соответствии с которым новые пользователи/роли начинают с минимальными разрешениями или вообще без них, а старые пользователи/роли не получают доступ к новым функциям до тех пор, пока доступ не будет явно назначен.
5. Контроль доступа отключается \(в том числе аварийно\) безопасно, в том числе при возникновении исключений.

### V4.2 Управление доступом на уровне ОС

**Требования низкого, среднего и высокого уровней:**

1. Конфиденциальные данные и API защищены от прямых атак на объекты, направленных на создание, чтение, обновление и удаление записей, например, создание или обновление чьей-либо записи, просмотр всех записей или удаление всех записей.
2. Приложение или фреймворк использует  анти-CSRF механизм для защиты аутентифицированной функциональности, а анти-автоматизация или анти-CSRF защищает неаутентифицированную функциональность.

### V4.3 Прочие соображения о контроле доступа

**Требования низкого, среднего и высокого уровней:**

1. Административные интерфейсы используют соответствующую многофакторную аутентификацию для предотвращения несанкционированного использования.
2. Просмотр каталогов отключен, если только это не требуется. Приложения не раскрывают метаданные файлов или каталогов, например, скрыты файлы с расширениями Thumbs.db, .DS\_Store, .git или .svn.

**Требования только среднего и высокого уровней:**

1. Для избежания мошеннических действий, приложение имеет дополнительную авторизацию \(например, с постепенным повышением привилегий или адаптивную аутентификацию\) для систем с более низкой стоимостью и / или разделение обязанностей для приложений с высокой стоимостью.

### V5.2 Песочника и санитизация

**Требования низкого, среднего и высокого уровней:**

1. Весь недоверенный HTML ввод от редакторов WYSIWYG или аналогичных санитизирован с помощью библиотеки санитизации HTML или с помощью функционала фреймворка. 
2. Неструктурированные данные санитизируются, чтобы предотвратить использование опасных последовательностей символов и превышение длинны строки. 
3. Приложение санитизирует ввод пользователя, прежде чем направлять его в почтовые сервисы, чтобы избежать  SMTP или IMAP инъекций.
4. Приложение не использует функцию  eval\(\) или других функций динамического исполнения кода. Если нет альтернативы, любой ввод пользователя должен быть санитизирован или помещен в песочницу, прежде чем исполняться.
5. Приложение защищено от атаки внедрения шаблона, санитизируя или отправляя в песочницу любой ввод пользователя.
6. Приложение защищено от SSRF атак валидируя и санитизируя недоверенные данные или метаданные, используется белый список протоколов, доменов, путей и портов. 
7. Приложение санитизирует, отключает или отправляет в песочницу отправляемый пользователем контент, содержащий SVG скрипты, так как они могут содержать XSS или foreignObject. 
8. Приложение санитизирует, отключает или отправляет в песочницу отправленный пользователем контент, написанный на скриптовых языках, например Markdown, CSS или XSL stylesheets, BBCode и прочие.

### V5.3 Кодирование вывода и предотвращение инъекций

**Требования низкого, среднего и высокого уровней:**

1. Кодирование на вывод соответствует интерпретатору и контексту. Например, используются отдельные кодировщики для значений, атрибутов HTML, для JavaScript, параметров, заголовков URL, SMTP и других интерпретаторов, в зависимости от контекста, особенно для недоверенного ввода \(имена с символами юникода или с апострофами, например ねこ или O'Hara\).
2. Кодирование на вывод обрабатывает набор символов и локаль, выбранные пользователем \(каждый символ юникода валиден и безопасно обрабатывается\).
3. Производится, в зависимости от контекста, автоматическое или, в худшем случае, ручное экранирование для защиты от XSS атак \(например, reflected, stored и DOM\)
4. Выбор данных или запросы к базам данных \(SQL, HQL, ORM, NoSQL\) используют параметризированные запросы, ORM, фреймворки ввода или как-либо иначе защищены от инъекций в БД. 
5. В случаях, когда не используется параметризация или иных безопасных механизмов нет, используется кодирование вывода \(в зависимости от контекста\) для защиты от инъекций, например, используется SQL экранирование, чтобы предотвратить SQL инъекции. 
6. Приложение защищено от JavaScript или JSON инъекций, включая атаки eval\( \), внедрение JavaScript, обход CSP, DOM XSS.
7. Приложение защищено от LDAP инъекций или были предприняты меры по предотвращению таких инъекций. 
8. Приложение защищено от инъекций команд в ОС и вызовы ОС производятся при помощи параметризированных запросов. 
9. Приложение щашишено от атак LFI и RFI. 
10. Приложение защинено от XPath или XML инъекций. 

### V6.1 Шифрование данных

**Требования среднего и высокого уровней:**

1. Регулируемые законами персональные данные хранятся в зашифрованном виде \(например, личные данные, чувствительная личная информация или данные, являющиеся объектом регламента GDPR\) 
2. Регулируемые законами данные о здоровье хранятся в зашифрованном виде \(например, медицинские записи, данные с медицинских устройств или деанонимизированные записи исследований\). 
3. Регулируемые законом финансовые данные хранятся в зашифрованном виде \(например, данные аккаунтов, кредитная история, налоговые записи, история платежей, бенефициары или деанонимизированные записи маркетинговых и иных исследований\). 

### V6.2 Алгоритмы

**Требования низкого, среднего и высокого уровней:**

1. Все криптографические модули отказывают безопасно и ошибки обрабатываются так, чтобы невозможно было организовать атаку Padding Oracle.

**Требования только среднего и высокого уровней:**

1. Используются общие для индустрии или утвержденные правительством криптографические алгоритмы, режимы и библиотеки, самодельные алгоритмы не используются. 
2. Вектор инициализации шифрования, конфигурация шифра, режимы блока настроены безопасно. 
3. Алгоритмы генерации случайного числа, шифрования или хеширования, длины ключа, округления, шифра или режимов могут быть перенастроены, обновлены или заменены в любое время, чтобы защититься от дыр в криптографии. 
4. Не используются небезопасные режимы шифрования \(ECB и так далее\),  дополнения \(PKCS\#1 v1.5 и так далее\), шифры с малым размером блока \(Triple-DES, Blowfish и так далее\) и слабые алгоритмы хеширования \(MD5, SHA1 и так далее\) за исключением случаев, когда необходимо реализовать обратную совместимость. 
5. Одноразовые числа и векторы инициализации должны использоваться только один раз для данного криптографического ключа. Метод генерации ключа должен подходить для используемого алгоритма шифрования. 

**Требования только высокого уровня:**

1. Зашифрованные данные аутентифицируются через подписи, аутентифицированные режимы шифрования или через HMAC, чтобы удостовериться, что шифротекст не изменяется несанкционированной стороной. 
2. Все криптографические операции происходят за определенное время, нет "обходных путей" в операциях сравнения, вычисления, чтобы избежать утечек информации. 

### V6.3 Случайные значения

**Требования среднего и высокого уровней:**

1. Все случайные числа, имена файлов, GUID'ы и случайные строки генерируются при помощи безопасных криптографических модулей, генератор случайных чисел не предугадается атакующим. 
2. Случайные GUID'ы созданы с использованием алгоритма GUID v4 и криптографически безопасного генератора псевдо-рандомных чисел \(CSPRNG\). GUID, созданный при помощи других генераторов псевдо-рандома, может быть предсказуемым. 

**Требования только высокого уровня:**

1. Случайные числа созданы при помощи достаточной энтропии даже когда приложение находится под высокой нагрузкой. 

### V6.4 Управление секретами

**Требования среднего и высокого уровней:**

1. Используется решение для управления секретами, например, хранилище ключей используется для того, чтобы создавать, хранить, контролировать доступ и уничтожать секреты. 
2. Ключи генерируются не в приложении, а в изолированном безопасном модуле для криптографических операций. 

### V8.3 Конфиденциальные личные данные

**Требования низкого, среднего и высокого уровней:**

1. Все конфиденциальные данные создаваемые и обрабатываемые приложением определены и используются политики обработки этих данных. 

**Требования только среднего и высокого уровней:**

1. Доступ к конфиденциальным данным логируется \(при этом не логируются сами данные\) в случае, если данные собраны в соответствии с директивами защиты данных или когда логирование доступа необходимо. 
2. Конфиденциальная информация, хранимая в памяти, перезаписана нулями или случайными данными сразу после того, как в ее использовании отпала необходимость, чтобы смягчить последствия атак выгрузки памяти. 
3. Конфиденциальные данные, которые необходимо шифровать, зашифрованы с использованием алгоритмов, гарантирующих конфиденциальность и целостность. 
4. Конфиденциальные личные данные описаны в классификации хранения данных, например, старые или устаревшие данные удаляются автоматически, по расписанию или в зависимости от ситуации. 

### V9.1 Безопасность коммуникаций

**Требования низкого, среднего и высокого уровней:**

1. TLS используется для всех клиентских соединений и под нагрузкой не используется другой небезопасный протокол коммуникации. 
2. Используются онлайн или обновленные средства тестирования TLS, которые проверяют, что используются только надежные алгоритмы, шифры. 
3. Устаревшие версии SSL и TLS протоколов, алгоритмов, шифров и конфигураций отключены. Например, отключены SSLv2, SSLv3 или TLS 1.0 и 1.1. 

### V9.2 Безопасность серверных коммуникаций

**Требования среднего и высокого уровней:**

1. Соединения от и к серверу используют доверенные TLS сертификаты. Когда используются самоподписанные сертификаты, сервер должен быть настроен доверять только специальным внутренним центрам сертификации. Остальные должны быть отклонены.  
2. Для всех входящих и исходящих соединений используется защищенный \(с использованием шифрования\) протокол коммуникации, такой как TLS, включая управление портами, мониторинг, аутентификацию, API, вызовы веб-сервисов, базы данных, облачные, бессерверные, мейнфрейм, внешние и партнерские соединения. Сервер под нагрузкой не должен переключаться на использование незашифрованных протоколов. 
3. Все зашифрованные соединения с внешними системами, при которых используется конфиденциальная информация или функции, аутентифицируются. 
4. Используется надежное средство отзыва сертификатов, например подключена и настроена система Online Certificate Status Protocol \(OCSP\) Stapling.

**Требования только высокого уровня:**

1. Ошибки соединений TLS логируются на бекенде. 

### V10.2 Поиск вредоносного кода

**Требования среднего и высокого уровней:**

1. Исходный код приложения и сторонних библиотек не содежрит функций неавторизованного сбора данных. Если такая функциональность существует, получите пользовательское разрешение на сбор данных, прежде чем его производить. 
2. Приложение не запрашивает чрезмерный доступ к разрешениям в части приватных функций или сенсоров, например, доступ к контактам, камерам, микрофонам или геолокации. 

**Требования только высокого уровня:**

1. Исходный код приложения и сторонние библиотеки не содержат бекдоров, как, например, жестко закодированных или дополнительных недокументированных  аккаунтов, ключей, обфускаций, недокументированных бинарных объектов, руткитов, анти-дебаг или небезопасный дебаг или иным образом устаревшую, небезопасную или скрытую функциональность, которую атакующий может использовать, если обнаружит. 
2. Исходный код приложения и сторонние библиотеки не содержат бомб замедленного действия, весь код просканирован на наличие функций, связанных с датой и временем. 
3. Исходный код приложения и сторонние библиотеки не содержат вредоносного кода, например, salami attacks, logic bypasses, logic bombs.
4. Исходный код приложения и сторонние библиотеки не содержат в себе пасхальных яиц или иной нежелаемой функциональности. 

### V12.2 Целостность файлов

**Требования среднего и высокого уровней:**

1. Контент файлов, полученных от недоверенных источников, проверяется на соответствие формату. 

### V12.3 Обработка файлов

**Требования низкого, среднего и высокого уровней:**

1. Отправленные пользователем метаданные файла не используются напрямую системой,  фреймворком или API URL, чтобы избежать уязвимости path traversal.
2. Имя файла, отправленного пользователем, валидируется или игнорируется, чтобы предотвратить раскрытие, создание, обновление или удаление локальных файлов \(LFI\).
3. Имя файла, отправленного пользователем, валидируется или игнорируется, чтобы предотвратить раскрытие или запуск удаленных файлов \(RFI\), что может также привести к SSRF атаке. 
4. Приложение защищено от атаки reflective file download \(RFD\), оно валидирует или игнорирует отправленные пользователем имена файлов в JSON, JSONP или URL параметрах, в ответах заголовки Content-Type должны содержать чистый текст, заголовки Content-Disposition должны иметь фиксированное имя файла. 
5. Метаданные недоверенных файлов не используются напрямую в API или библиотеках для предотвращения инъекций команд в ОС. 

**Требования только среднего и высокого уровней:**

1. Приложение не включает в себя и не исполняет функционал из недоверенных источников, как, например, из неподтвержденных CDN, библиотек JavaScript, npm библиотек или серверных DLL. 

### V12.4 Хранение файлов

**Требования низкого, среднего и высокого уровней:**

1. Файлы, полученные из недоверенных источников, хранятся за пределами директории веб-приложения, ограничены в разрешениях со строгой валидацией. 
2. Файлы, полученные из недоверенных источников, сканируются антивирусом, чтобы предотвратить загрузку известного вредоносного кода. 

### V12.6 Защита от SSRF

**Требования низкого, среднего и высокого уровней:**

1. В приложении и на сервере используется белый список ресурсов и систем, к которым сервер может отправлять запросы или с которых он может загружать данные и файлы. 

### V13.4 GraphQL и прочие слои данных веб-сервисов

**Требования среднего и высокого уровней:**

1. Белый список запросов или комбинация лимитов на глубину и количество запросов используются для предотвращения DoS, как результата сложных, вложенных запросов. Для более продвинутых сценариев, следует использовать анализ стоимости запроса. 
2. Авторизация в GraphQL или ином другом слое данных производится на уровне бизнес-логики, вместо уровня GrapgQL. 

### V14.5 Валидация заголовков HTTP запросов

**Требования низкого, среднего и высокого уровней:**

1. Сервер приложения принимает только те методы HTTP, которые используются приложением или API, включая pre-flight OPTIONS. 
2. Полученный заголовок Origin не используется для аутентификации или в управлении доступом, так как этот заголовок может быть легко изменен атакующим. 
3. Заголовок cross-domain resource sharing \(CORS\) Access-Control-AllowOrigin использует строгий белый список доверенных доменов и не принимает параметр "null".

**Требования только среднего и высокого уровней:**

1. Заголовки HTTP, добавленные доверенными прокси или через SSO, аутентифицируются приложением. 

### V5.1 Проверка ввода

**Требования низкого, среднего и высокого уровней:**

1. Приложение защищено от атак загрязнения HTTP параметров, особенно, если фреймворк приложения не различает источник параметров запроса \(GET, POST, куки, заголовки или переменные окружения. 
2. Фреймворк защищен от массового присвоения параметров или приложение имеет контр-меры, чтобы предотвратить небезопасное присвоение параметров. 
3. Весь ввод \(поля форм HTML, запросы REST, параметры URL, заголовки HTTP, куки, исполняемые файлы, RSS рассылки и прочее\) валидируются с использованием белого списка. 
4. Все структурированные данные строго типизированы и валидируются через описанную схему, содержащую разрешенные символы, длину и патерны \(номера кредитных карт или телефон или проверка на факт соответствия указанного города индексу\). 
5. URL перенаправляет только на ресурсы из белого списка или показывает предупреждение, когда перенаправление происходит на потенциально ненадежный контент. 

## Сборка и развертывание

### V10.1 Контроль целостности кода

**Требования высокого уровня:**

1. Используется средство анализа кода, выявляющее потенциально уязвимый код, как, например функции времени, небезопасные операции с файлами и сетевые соединения. 

### V10.3 Контроль целостности развернутого приложения

**Требования низкого, среднего и высокого уровней:**

1. Приложение имеет функцию автообновления клиента или сервера, обновления происходят через защищенный канал с использованием цифровой подписи. Код обновления должен подтверждать цифровую подпись прежде чем устанавливать или исполнять обновление. 
2. Приложение использует защиту целостности, как, например, подпись кода или целостность подресурса. Приложение не должно загружать или исполнять код из недоверенных источников, как, например, плагины, код, библиотеки. 
3. Приложение имеет защиту от угона поддоменов. Проверяются записи DNS или CNAME на предмет устарелости. Производится регулярная проверка доменных имен, используемых в приложении на предмет истечения срока действия или изменения. 

### V14.1 Сборка

**Требования среднего и высокого уровней:**

1. Процессы сборки и развертывания приложения производятся безопасно, например, произведена автоматизация CI /CD, автоматизированы конфигурации и существуют скрипты автоматического развертывания. 
2. Флаги компилятора настроены таким образом, чтобы обеспечить безопасную сборку \(включение всех доступных оповещений о переполнении буфера, рандомизация стека, предотвращение исполнения данных, остановка сборки если найдены небезопасные операции с указателями, памятью, форматированием строк\)
3. Конфигурация сервера настроена в соответствии с рекомендациями приложения сервера и используемых фреймворков. 
4. Приложение, конфигурации и все зависимости могут быть развернуты при помощи скриптов, составленных из документированных и протестированных последовательностей команд в разумные сроки или они могут быть восстановлены из резервных копий своевременно. 

**Требования только высокого уровня:**

1. Авторизованные администраторы могут проверить целостность всех важных с точки зрения безопасности конфигураций для определения вмешательства в них. 

### V14.2 Зависимости

**Требования низкого, среднего и высокого уровней:**

1. Все компоненты обновлены. Во время сборки или компиляции используется dependency checker для проверки версий библиотек. 
2. Все неиспользуемые функции, документация, примеры и конфигурации удалены, например, тестовые приложения, документация платформы или пользователи по умолчанию и временные пользователи для тестов. 
3. Если элементы приложения, такие как библиотеки JavaScript, таблицы стилей CSS или шрифты хранятся во внешней сети доставки контента \(CDN\) или у внешнего провайдера, то используются средства проверки целостности ресурсов \(Subresource Integrity или SRI\). 

**Требования только среднего и высокого уровней:**

1. Все сторонние компоненты поставляются от определенных, доверенных и постоянно обновляемых репозиториев. 
2. Существует перечень всех используемых сторонних библиотек. 
3. Сторонние библиотеки работают из песочницы или через wrapper'ы, чтобы добиться только требуемого от них поведения в приложении для уменьшения поверхности атаки.

## Тестирование

### V2.1 Безопасность паролей

**Требования низкого, среднего и высокого уровней:**

1. Пароли, установленные пользователем, не менее 12 символов в длину. 
2. Пароли длиннее 64 символов разрешены. 
3. Пароли могут содержать пробелы и они не обрезаются. 
4. Символы юникода разрешены в паролях. 
5. Пароли могут менять их пароль. 
6. Смена пароля требует ввода текущего и нового пароля. 
7. Введенные при регистрации, логин и пароль проверяются на предмет утечки локально \(например, используя топ-1000 или топ-10000 самых частых паролей\) или используя внешний API. Если используется внешний API, то используется доказательство с нулевым разглашением или другой механизм, чтобы удостовериться, что пароль не отправляется в чистом виде. Если пароль найден в утечках, то пользователю требуется поставить новый, безопасный пароль. 
8. Измерение сложности пароля отображается, чтобы помочь пользователю установить сложный пароль. 
9. Нет правил составления пароля, лимитирующих использование символов. Не должно быть требования об использовании заглавных или строчных букв, чисел или специальных символов. 
10. Нет требований к периодической ротации учетных данных или истории паролей. 
11. Функция "вставить", расширения менеджеров паролей для браузеров и внешние менеджеры паролей разрешены. 
12. Пользователь может временно показать замаскированный пароль или временно показать последние символы пароля. 

### V2.5 Восстановление учетных данных

**Требования низкого, среднего и высокого уровней:**

1. Сгенерированный системой начальный ключ активации или восстановления секрета не отправляется в виде чистого текста пользователю. 
2. Подсказки для паролей или "секретные вопросы" не используются. 
3. Процесс восстановления пароля не показывает текущий пароль. 
4. Общие аккаунты и стандартные \(например, "root", "admin" или "sa"\) не представлены в системе. 
5. Если способ аутентификации изменен или удален, пользователь уведомляется об этом. 
6. При восстановлении пароля или при иных действиях восстановления, используется безопасный механизм восстановления, например, TOTP или пуш-уведомления или другой механизм восстановления офлайн. 

**Требования только среднего и высокого уровней:**

1. Если данные для мультифакторной аутентификации утеряны, то для восстановления требуется данных и действий не меньше, чем при регистрации. 

### V2.6 Look-up секреты

**Требования среднего и высокого уровней:**

1. Lookup-секреты могут быть использованы только единожды. 
2. Lookup-секреты имеют достаточную случайность \(112 бит энтропии\) или менее 112 битов энтропии с применением значения соли с уникальным 32-битным значением и односторонним хешированием. 
3. Lookup-секреты устойчивы к офлайн-атакам, например, перебор значений для поиска закономерности. 

### V2.7 Out of Band верификатор

**Требования низкого, среднего и высокого уровней:**

1. 1. Verify that clear text out of band \(NIST "restricted"\) authenticators, such as SMS or PSTN, are not offered by default, and stronger alternatives such as push notifications are offered first.
2. Verify that the out of band verifier expires out of band authentication requests, codes, or tokens after 10 minutes. 
3. Verify that the out of band verifier authentication requests, codes, or tokens are only usable once, and only for the original authentication request.
4. Verify that the out of band authenticator and verifier communicates over a secure independent channel.

**Требования только среднего и высокого уровней only:**

1. Verify that the out of band verifier retains only a hashed version of the authentication code.
2. Verify that the initial authentication code is generated by a secure random number generator, containing at least 20 bits of entropy \(typically a six digital random number is sufficient\).

### V2.8 Одноразовый код при одно- и мультифакторной верификации

**Требования низкого, среднего и высокого уровней:**

1. Одноразовые пароли истекают за определенное время. 

**Требования только среднего и высокого уровней:**

1. Используются симметричные ключи, чтобы отправленные ключи были хорошо защищены, например, используются аппаратные модули безопасности или хранилища ключей на основе безопасной ОС. 
2. Используются надежные криптографические алгоритмы при генерации и верификации. 
3. Одноразовый пароль может быть использовать только один раз в период его действия. 
4. Если одноразовый токен использован более одного раза, то это действие логируется и токен отвергается с отправкой уведомления безопасности владельцу устройства. 
5. Физический генератор одноразовых паролей может быть отозван в случае его кражи или потери. Все активные сессии, в которых используются ключи этого устройства, отзываются вне зависимости от локации. 
6. Биометрическая аутентификация используется только как дополнительное средство аутентификации вместе с использованием чего-нибудь, что пользователь имеет или с тем, что он знает. 

### V2.9 Криптографическое ПО и устройства верификации

**Требования среднего и высокого уровней:**

1. Криптографические ключи, используемые при верификации, хранятся в безопасности и защищены от раскрытия. Например, используется  TPM или HSM или сервис ОС, использующий секретное хранилище. 
2. Случайное число составляет не менее 64 битов в длину, статистически уникально или уникально на время использования криптографического устройства. 
3. Используются проверенные алгоритмы при генерации и верификации. 

### V2.10 Аутентификация сервисов

**Требования среднего и высокого уровней:**

1. Секреты интеграций не зависят от несменяемых паролей \(API ключи, общие привилегированные аккаунты\)
2. Пароли хранятся в безопасном месте, чтобы предотвратить восстановление их офлайн перебором. 
3. Пароли, интеграции с базами данных и сторонними системами, внутренние секреты и ключи API хранятся безопасно и не включены в исходный код и не хранятся в репозиториях исходного кода. Хранилище секретов должно быть устойчиво к офлайн перебору

### V3.1 Фундаментальные принципы администрирования сеансов

**Требования низкого, среднего и высокого уровня:**

1. Приложение никогда не отображает токены сессий в URL параметрах или в сообщениях об ошибках системы.

### V3.2 Требования к связи сеансов с соответствующими пользователями

**Требования низкого, среднего и высокого уровней:**

1. Приложение генерирует новый сессионный токен при аутентификации пользователя. 
2. Токены включают не менее 64-х бит энтропии.
3. Приложение хранит токены только в браузере используя безопасные методики, такие как защищённые куки, или хранение данных сеанса в HTML 5.

   **Требования только среднего и высокого уровней:**

4. Токены сеанса генерируются применяя только проверенные криптографические алгоритмы.

### V3.3 Завершение сессии и ее таймаут

**Требования низкого, среднего и высокого уровней:**

1. Выход из учётной записи, а также истечения срока аутентификации нейтрализуют токены сеанса, к примеру чтобы кнопки навигации или системы зависящие от входящих потоков не возобновляли аутентифицированный сеанс, включая системы последующих уровней зависимости. 
2. При позволении верификатором оставаться пользователям в учётной записи, повторные аутентификации проходят периодически вне зависимости от степени активности пользователя.

**Требования только среднего и высокого уровней:**

1. Приложение приостанавливает все активные сессии при смене пароля кроме той, откуда происходит успешная смена пароля. Процедура работает на всех уровнях и ветвях приложения.
2. Пользователь имеет возможность выйти из учётных записей, приостановляя тем самым активные сессии на разных или всех устройствах.

### V3.4 Управление куки-сессиями

**Требования низкого, среднего и высокого уровней:**

1. Токены куки имеют 
   1. Атрибут 'Secure'. 
   2. Атрибут 'HttpOnly'. 
   3. Атрибут 'SameSite' для предотвращения CSRF атак \(в отличие от скриптовых аттак, они вынуждают пользователя произвести вредоносный запрос\).
2. Токены куки используют "\_\_Host-" префикс для подтверждения своей конфиденциальности.
3. Если приложение опубликовано на домене с другими приложениями, позволяющими модифицировать куки каким-либо способом,  атрибут пути сообщается самым точным возможным способом.

### V3.5 Управление токен-сессиями

**Требования только среднего и высокого уровней:**

1. Приложение не обращается к OAuth само по себе с целью обновления токенов, при этом позволяет пользователю отзывать токен от привязанных приложений. 
2. Приложение использует токены сеансов вместо статичных API, секретов и ключей, если это не легаси-приложение.
3. Токены используют цифровую подпись, шифрование и прочие контрмеры, чтобы предотвратить следующие атаки: parameter tampering, enveloping, replay, null cipher, key substitution.

### V3.6 Повторная аутентификация

**Требования высокого уровня:**

1. Зависимые стороны указывают в CSP максимальное время для прохождения аутентификации, а CSP требует повторной аутентификации, если сторона не использовала выданную сессию за указанное время. 
2. CSP информирует стороны о последних событиях аутентификации, чтобы дать возможность RP понять, есть ли необходимость в повторной аутентификации клиента. 

### V3.7 Защита системы управления сессиями от эксплоитов

**Требования низкого, среднего и высокого уровней:**

1. Приложение проверяет, что используется валидная сессия или требует повторной аутентификации или верификации через второй фактор, прежде чем позволить пользователю производить конфиденциальные транзакции или вносить изменения в аккаунт. 

### V5.4 Память, строка

**Требования среднего и высокого уровней:**

1. Приложение использует безопасные для памяти строки, безопасное копирование памяти и арифметику указателей, чтобы предотвратить переполнение стека, буфера или heap overflow. 
2. Форматируемые строки не принимают потенциально опасный ввод и стабильны. 
3. Используется валидация ввода, диапазона и подписи, чтобы предотвратить целочисленное переполнение. 

### V5.5 Предотвращение десериализации

**Требования низкого, среднего и высокого уровней:**

1. Сериализованные объекты используют проверку целостности или зашифрованы, чтобы предотвратить создание вредоносного объекта или вмешательство в память. 
2. Чтобы предотвратить XXE атаки, приложение корректно ограничивает XML парсеры, позволяя им использовать максимально ограниченную конфигурацию, чтобы удостовериться, что небезопасные опции отключены, например, разрешение внешнего ввода. 
3. Десериализация недоверенных данных избегается или используется безопасная десериализация кастомного кода и сторонних библиотек \(например, библиотек для JSON, XML, YAML\).
4. При парсинге JSON в браузерах или на JavaScript бекендах, используется метод JSON.parse. Для парсинга JSON не используется eval\(\). 

### V8.2 Защита данных на стороне клиента

**Требования низкого, среднего и высокого уровней:**

1. Приложение устанавливает подходящие заголовки для предотвращения кеширования, чтобы предотвратить кеширование конфиденциальных данных в браузерах. 
2. Данные, хранимые на стороне клиента \(например, локальное хранилище HTML5, хранилище сессий, IndexedDB, куки или Flash куки\) не содержат конфиденциальных или персональных данных. 
3. Данные, получаемые после аутентификации, удаляются из хранилища на стороне клиента \(например, DOM браузера удаляется, когда сессия разорвана\). 

### \*V11.1 Безопасность бизнес-логики

**Требования низкого, среднего и высокого уровней:**

1. Приложение исполняет шаги бизнес логики для пользователя последовательно и без пропуска шагов. 
2. Приложение исполняет каждый шаг бизнес логики в реалистичное время для человека, другими словами, транзакции не проводятся слишком быстро. 
3. Приложение имеет лимиты для отдельных бизнес процессов или транзакций, которые выполняются для каждого пользователя отдельно. 
4. В приложении реализованы лимиты для обнаружения и защиты от автоматизированных атак по типу фильтрации данных, чрезмерного обращения к процессам бизнес логики, чрезмерной загрузки файлов или DOS \(отказ в обслуживании\)
5. Приложение имеет лимиты для бизнес логики или валидации для защиты от возможных бизнес-рисков или угроз, выявленных с помощью моделирования угроз или похожих методик. 

**Требования только среднего и высокого уровней:**

1. Приложение не испытывает проблем с "time of check to time of use" \(TOCTOU\) и других проблем с важными процессами в состоянии гонки. 
2. Приложение отслеживает необычные события или активность с точки зрения бизнес-логики. Например, попытки совершить действия не по порядку или действия, которые обычный пользователь никогда бы не предпринял. 
3. Приложение имеет настраиваемую систему оповещения об обнаружении автоматизированных атаках или необычной активности. 

### V12.1 Загрузка файлов на сервер

**Требования низкого, среднего и высокого уровней:**

1. Приложение не принимает большие файлы, которые могут заполнить хранилище или вызвать DOS атаку. 

**Требования среднего и высокого уровней only:**

1. Архивированные файлы проверяются на наличие zip-бомб - маленьких файлов, которые, при разархивировании заполнят все хранилище. 
2. Используется ограничение по объему загружаемого файла и количеству файлов на пользователя, чтобы пользователи не могли загружать слишком много файлов или слишком большие файлы. 

### V12.5 Загрузка файлов с сервера

**Требования низкого, среднего и высокого уровней:**

1. Веб настроен обслуживать файлы только с определенным разрешением, чтобы предотвратить непреднамеренную утечку кода и информации. Например, файлы восстановления \(.bak\), временные служебные файлы \(.swp\), сжатые файлы \(.zip, .tar.gz\) и прочие распространенные расширения, используемые редакторами, заблокированы, если только в них нет необходимости. 
2. Прямые запросы к загруженным файлам не производятся с использованием HTML/JavaScript. 

### V13.1 Общая безопасность веб-сервиса

**Требования низкого, среднего и высокого уровней:**

1. Все компоненты приложения используют одинаковые кодировки и парсеры, чтобы предотвратить парсинг атаки, эксплуатирующие различные URI или парсинг файлов,  используемый для потенциальных SSRF и RFI атак. 
2. Функции администрирования и менеджмента доступны только для авторизованных администраторов. 
3. URL API не раскрывают конфиденциальную информацию, такую как ключи API и токены сессий.

**Требования среднего и высокого уровней only:**

1. Решение об авторизации принимаются URI с использованием программного или декларативного контроля на уровне контроллера или роутера, а на ресурсном уровне используются model-based разрешения. 
2. Запросы, содержание неожиданные или в которых отсутствуют ожидаемые content-type, отклоняются с применением подходящих HTTP-заголовков \(406 Unacceptable или 415 Unsupported Media Type\).

### V13.2 Безопасность RESTful веб-сервиса

**Требования низкого, среднего и высокого уровней:**

1. Включенные методы RESTful HTTP подходят для пользователей и действий. Например, у обычного пользователя нет доступа к методам DELETE или PUT на защищенных ресурсах API.
2. Используется валидация JSON-схемы, она верифицируется, прежде чем принять ввод.   
3. RESTful веб-сервисы, использующие куки, защищены от CSRF атак через использование как минимум одной или большего числа следующих практик: паттерн тройного или двойного предоставления куки, CSRF nonces, проверка ORIGIN заголовков запроса. 

**Требования среднего и высокого уровней only:**

1. REST сервисы используют контроль против автоматизации атак, например, против массированных звонков, отправки СМС, если API не аутентифицировано. 
2. REST сервисы явно проверяют входящие Content-Type заголовки на предмет содержания их в списке ожидаемых, например application/xml or application/JSON.
3. Заголовки сообщений и их содержание являются доверенными и не были модифицированы при транспортировке. Требование использовать защищенное соединение \(TLS\) может быть достаточным во многих случаях, так как TLS предоставляет защиту конфиденциальности целостности. Цифровые подписи для каждого сообщения могут предоставить дополнительную защиту для высоко защищенных приложений, но добавляют им дополнительную комплексность, в силу чего риски могут перевесить пользу. 

### V14.3 Непреднамеренное раскрытие информации

**Требования низкого, среднего и высокого уровней:**

1. Сообщения об ошибках фреймворка, веб и серверных приложений настроены и доставляют пользователю актуальные, персонализированные ответы для избежания непреднамеренного раскрытия конфиденциальной и иной критичной с точки зрения безопасности системной информации.   
2. Отладочные режимы фреймворка, веб и серверных приложений отключены в рабочем окружении, чтобы опции отладки, консоли разработчика были отключены во избежание непреднамеренного раскрытия конфиденциальной и иной критичной с точки зрения безопасности системной информации.   
3. Заголовки или иные части HTTP ответа не раскрывают детальную информацию о компонентах системы и информацию о версиях.  

### V14.4 HTTP Security Headers Requirements

**Требования низкого, среднего и высокого уровней:**

1. Каждый ответ HTTP содержит заголовки Content-Type, указывающие набор безопасных символов \(например, UTF-8, ISO 8859-1\).
2. Все ответы API содержат заголовок Content-Disposition: attachment; filename="api.json" \(или другое подходящие имя\).
3. Используется политика безопасности контента \(CSPv2\), которая помогает смягчить влияние XSS атак, таких как HTML, DOM, JSON, JavaScript инъекции. 
4. Ответы содержат заголовок X-Content-Type-Options: nosniff.
5. Во всех ответах на всех поддоменах используются заголовки HTTP Strict Transport Security, например, Strict-Transport-Security: max-age=15724800; includeSubdomains.
6. Используются подходящие заголовки "Referrer-Policy", например "no-referrer" или "same-origin".
7. Используются подходящие заголовки X-Frame-Options или Content-Security-Policy: frameancestors для тех сайтов, в которые контент не должен быть встроен. 

## Поддержка

### V7.1 Логирование контента

**Требования низкого, среднего и высокого уровней:**

1. Приложение не логирует учетные данные или детали платежей. Токены сессий хранятся в логах в хешированном виде. 
2. Приложение не логирует конфиденциальные данные, например данные, определенные локальными законами о конфиденциальности или политиками безопасностями. 

**Требования среднего и высокого уровней only:**

1. Приложение логирует события успешной или неудачной аутентификации, ошибки контроля доступа, ошибки десериализации и ошибки валидации ввода. 
2. Каждое событие в логах включает в себя необходимую информацию с указанием времени, чтобы можно было провести детальное расследование последовательности действий, если произойдет инцидент. 

### V7.2 Обработка логов

**Требования среднего и высокого уровней:**

1. Все решения об аутентификации логируются без сохранения конфиденциальной информации, например, идентификаторов сессий или паролей. Логи должны включать запросы с метаданными, необходимые для расследования инцидентов. 
2. Логируются все решения контроля доступа и все отклоненные запросы. Логи должны включать в себя зпросы с метаданными, необходимые для расследования инцидентов.

### V7.3 Защита логов

**Требования среднего и высокого уровней:**

1. Приложение помечает предоставленные пользователем данные, чтобы предотвратить инъекцию логов. 
2. События логов защищены от инъекций, когда отображаются в ПО отображения логов. 
3. Логи безопасности защищены от неавторизованного доступа и модификации. 
4. Ресурсы получения времени синхронизированы с корректным временем и часовым поясом. В случае, если система глобальная, то используется UTC, чтобы облегчить анализ инцидентов. 

### V7.4 Обработка ошибок

**Требования низкого, среднего и высокого уровней:**

1. Показывается сообщение об ошибке, содержащее уникальный ID в случае, если произошли неожиданные ошибки или ошибки безопасности. Это требуется для облегчения расследования персоналу поддержки. 

**Требования среднего и высокого уровней only:**

1. Используется обработка исключений во всем коде, чтобы контролировать ожидаемые и неожиданные ошибки. 
2. Используется обработкик ошибок "last resort", чтобы получать все неожиданные исключения. 

### V8.1 Общая защита данных

**Требования среднего и высокого уровней:**

1. Приложение использует защиту от кэширования конфиденциальных данных в компонентах сервера, вроде балансировщика нагрузки и кэша приложения. 
2. Все кэшированные или временные копии конфиденциальных данных хранятся на сервере в защищенном от неавторизованного доступа месте или зачищаются, инвалидируются после доступа авторизованного пользователя. 
3. Приложение минимизирует количество параметров в запросе, например, скрытые поля, переменные Ajax, значения куки и заголовков. 
4. Приложение обнаруживает и уведомляет о чрезмерном количестве запросов от IP, пользователя, о чрезмерном количестве запросов в час или за день или по другому принципу. 

**Требования высокого уровня:**

1. Производятся регулярные резервные копии важных данных и проводятся тестовое восстановление данных. 
2. Резервные копии хранятся безопасно для предотвращения хищения ил порчи. 

