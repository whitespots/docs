# Untitled

### V1.5 Ввод и вывод

**Требования среднего и высокого уровней:**

1. Кодировка вывода происходит на фронтенде. 

### V1.14 Конфигурация

**Требования среднего и высокого уровней:**

1. Приложение не использует неподдерживаемые, небезопасные или устаревшие технологии на стороне клиента, например плагины NSAPI, Flash, Shockwave, ActiveX, Silverlight, NACL, или Java апплеты на стороне клиента.

### V4.3 Прочие соображения о контроле доступа

**Требования низкого, среднего и высокого уровней:**

1. Просмотр каталогов отключен, если только это не требуется. Приложения не раскрывают метаданные файлов или каталогов, например, скрыты файлы с расширениями Thumbs.db, .DS\_Store, .git или .svn.

### V5.2 Песочника и санитизация

**Требования низкого, среднего и высокого уровней:**

1. Весь недоверенный HTML ввод от редакторов WYSIWYG или аналогичных санитизирован с помощью библиотеки санитизации HTML или с помощью функционала фреймворка.  
2. Приложение санитизирует ввод пользователя, прежде чем направлять его в почтовые сервисы, чтобы избежать  SMTP или IMAP инъекций.
3. Приложение защищено от атаки внедрения шаблона, санитизируя или отправляя в песочницу любой ввод пользователя.
4. Приложение санитизирует, отключает или отправляет в песочницу отправляемый пользователем контент, содержащий SVG скрипты, так как они могут содержать XSS или foreignObject. 
5. Приложение санитизирует, отключает или отправляет в песочницу отправленный пользователем контент, написанный на скриптовых языках, например Markdown, CSS или XSL stylesheets, BBCode и прочие.

### V5.3 Кодирование вывода и предотвращение инъекций

**Требования низкого, среднего и высокого уровней:**

1. Кодирование на вывод соответствует интерпретатору и контексту. Например, используются отдельные кодировщики для значений, атрибутов HTML, для JavaScript, параметров, заголовков URL, SMTP и других интерпретаторов, в зависимости от контекста, особенно для недоверенного ввода \(имена с символами юникода или с апострофами, например ねこ или O'Hara\).
2. Кодирование на вывод обрабатывает набор символов и локаль, выбранные пользователем \(каждый символ юникода валиден и безопасно обрабатывается\).
3. Производится, в зависимости от контекста, автоматическое или, в худшем случае, ручное экранирование для защиты от XSS атак \(например, reflected, stored и DOM\)
4. Приложение защищено от JavaScript или JSON инъекций, включая атаки eval\( \), внедрение JavaScript, обход CSP, DOM XSS.

### V10.2 Поиск вредоносного кода

**Требования среднего и высокого уровней:**

1. Исходный код приложения и сторонних библиотек не содержит функций неавторизованного сбора данных. Если такая функциональность существует, получите пользовательское разрешение на сбор данных, прежде чем его производить. 
2. Приложение не запрашивает чрезмерный доступ к разрешениям в части приватных функций или сенсоров, например, доступ к контактам, камерам, микрофонам или геолокации. 

**Требования только высокого уровня:**

1. Исходный код приложения и сторонние библиотеки не содержат бекдоров, как, например, жестко закодированных или дополнительных недокументированных  аккаунтов, ключей, обфускаций, недокументированных бинарных объектов, руткитов, анти-дебаг или небезопасный дебаг или иным образом устаревшую, небезопасную или скрытую функциональность, которую атакующий может использовать, если обнаружит. 
2. Исходный код приложения и сторонние библиотеки не содержат в себе пасхальных яиц или иной нежелаемой функциональности. 

### V12.2 Целостность файлов

**Требования среднего и высокого уровней:**

1. Контент файлов, полученных от недоверенных источников, проверяется на соответствие формату. 

### V13.4 GraphQL и прочие слои данных веб-сервисов

**Требования среднего и высокого уровней:**

1. Белый список запросов или комбинация лимитов на глубину и количество запросов используются для предотвращения DoS, как результата сложных, вложенных запросов. Для более продвинутых сценариев, следует использовать анализ стоимости запроса. 
2. Авторизация в GraphQL или ином другом слое данных производится на уровне бизнес-логики, вместо уровня GraphQL. 

### V14.5 Валидация заголовков HTTP запросов

**Требования низкого, среднего и высокого уровней:**

1. Заголовок cross-domain resource sharing \(CORS\) Access-Control-AllowOrigin использует строгий белый список доверенных доменов и не принимает параметр "null".

### V14.2 Зависимости

**Требования низкого, среднего и высокого уровней:**

1. Все компоненты обновлены. Во время сборки или компиляции используется dependency checker для проверки версий библиотек. 
2. Все неиспользуемые функции, документация, примеры и конфигурации удалены, например, тестовые приложения, документация платформы или пользователи по умолчанию и временные пользователи для тестов. 
3. Если элементы приложения, такие как библиотеки JavaScript, таблицы стилей CSS или шрифты хранятся во внешней сети доставки контента \(CDN\) или у внешнего провайдера, то используются средства проверки целостности ресурсов \(Subresource Integrity или SRI\). 

**Требования только среднего и высокого уровней:**

1. Все сторонние компоненты поставляются от определенных, доверенных и постоянно обновляемых репозиториев. 
2. Существует перечень всех используемых сторонних библиотек. 
3. Сторонние библиотеки работают из песочницы или через wrapper'ы, чтобы добиться только требуемого от них поведения в приложении для уменьшения поверхности атаки.

### V3.6 Повторная аутентификация

**Требования высокого уровня:**

1. Зависимые стороны указывают в CSP максимальное время для прохождения аутентификации, а CSP требует повторной аутентификации, если сторона не использовала выданную сессию за указанное время. 
2. CSP информирует стороны о последних событиях аутентификации, чтобы дать возможность RP понять, есть ли необходимость в повторной аутентификации клиента. 

### V8.2 Защита данных на стороне клиента

**Требования низкого, среднего и высокого уровней:**

1. Приложение устанавливает подходящие заголовки для предотвращения кеширования, чтобы предотвратить кеширование конфиденциальных данных в браузерах. 
2. Данные, хранимые на стороне клиента \(например, локальное хранилище HTML5, хранилище сессий, IndexedDB, куки или Flash куки\) не содержат конфиденциальных или персональных данных. 
3. Данные, получаемые после аутентификации, удаляются из хранилища на стороне клиента \(например, DOM браузера удаляется, когда сессия разорвана\). 

